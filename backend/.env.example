# ============================================
# SecurePass Backend Configuration
# ============================================
# Copy this file to .env and fill in your values
# NEVER commit .env to version control!

# ============================================
# Server Configuration
# ============================================
PORT=4000
NODE_ENV=development

# Frontend origin for CORS (must match exactly)
FRONTEND_ORIGIN=http://localhost:3000

# ============================================
# Database
# ============================================
# PostgreSQL connection string
# Format: postgresql://USER:PASSWORD@HOST:PORT/DATABASE
DATABASE_URL=postgresql://securepass:securepass@localhost:5432/securepass

# ============================================
# JWT Configuration
# ============================================
# Generate secrets with: node -e "console.log(require('crypto').randomBytes(32).toString('hex'))"

# Access Token: Short-lived (15m default)
# Used for API authorization, stored in memory (not localStorage)
JWT_SECRET=REPLACE_WITH_64_CHAR_HEX_SECRET
JWT_ACCESS_EXPIRES_IN=15m

# Refresh Token: Long-lived (30d default)
# Stored in httpOnly cookie, used to get new access tokens
REFRESH_TOKEN_SECRET=REPLACE_WITH_DIFFERENT_64_CHAR_HEX_SECRET
JWT_REFRESH_EXPIRES_IN=30d

# ============================================
# Encryption - CRITICAL SECURITY
# ============================================
# MASTER_KEY: Used to wrap/unwrap per-user encryption keys
# MUST be exactly 32 bytes (256 bits), base64 encoded
# 
# Generate with: node -e "console.log(require('crypto').randomBytes(32).toString('base64'))"
# 
# PRODUCTION RECOMMENDATION:
# Use a Key Management Service (KMS) instead of env variable:
# - AWS KMS: https://aws.amazon.com/kms/
# - GCP Cloud KMS: https://cloud.google.com/kms
# - Azure Key Vault: https://azure.microsoft.com/services/key-vault/
# - HashiCorp Vault: https://www.vaultproject.io/
#
# If MASTER_KEY is lost, ALL encrypted data is UNRECOVERABLE!
MASTER_KEY=REPLACE_WITH_32_BYTE_BASE64_KEY

# ============================================
# Password Hashing
# ============================================
# bcrypt salt rounds (minimum 12 for security)
# Higher = more secure but slower (12 = ~250ms, 14 = ~1s)
BCRYPT_SALT_ROUNDS=12

# ============================================
# Google OAuth 2.0
# ============================================
# Create credentials at: https://console.cloud.google.com/apis/credentials
# 1. Create OAuth 2.0 Client ID (Web application)
# 2. Add authorized redirect URI: http://localhost:4000/api/auth/google/callback
GOOGLE_CLIENT_ID=your_google_client_id
GOOGLE_CLIENT_SECRET=your_google_client_secret
GOOGLE_CALLBACK_URL=http://localhost:4000/api/auth/google/callback

# ============================================
# GitHub OAuth
# ============================================
# Create OAuth App at: https://github.com/settings/developers
# 1. New OAuth App
# 2. Set Authorization callback URL: http://localhost:4000/api/auth/github/callback
GITHUB_CLIENT_ID=your_github_client_id
GITHUB_CLIENT_SECRET=your_github_client_secret
GITHUB_CALLBACK_URL=http://localhost:4000/api/auth/github/callback

# ============================================
# OAuth Redirect
# ============================================
# Where to redirect after successful OAuth login
OAUTH_SUCCESS_REDIRECT=http://localhost:3000/oauth-success.html

# ============================================
# Rate Limiting (optional overrides)
# ============================================
# RATE_LIMIT_WINDOW_MS=900000       # 15 minutes
# RATE_LIMIT_MAX_REQUESTS=100       # requests per window
# AUTH_RATE_LIMIT_MAX_REQUESTS=20   # auth requests per window
